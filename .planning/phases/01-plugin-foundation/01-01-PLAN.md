---
phase: 01-plugin-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude-plugin/plugin.json
  - CLAUDE.md
  - scripts/init-director.sh
  - scripts/session-start.sh
  - hooks/hooks.json
autonomous: true

must_haves:
  truths:
    - "Plugin loads in Claude Code and namespaces all skills as /director:*"
    - "Running any /director: command when .director/ doesn't exist creates it silently"
    - "Git is auto-initialized silently if no .git/ exists"
    - "Session start hook loads project state summary into context"
  artifacts:
    - path: ".claude-plugin/plugin.json"
      provides: "Plugin manifest registering Director with Claude Code"
      contains: '"name": "director"'
    - path: "CLAUDE.md"
      provides: "Plugin-level persistent instructions loaded into every agent context"
      min_lines: 20
    - path: "scripts/init-director.sh"
      provides: "Silent .director/ folder creation with all expected files"
      contains: "mkdir -p"
    - path: "scripts/session-start.sh"
      provides: "Session start hook that loads project state"
      contains: "STATE.md"
    - path: "hooks/hooks.json"
      provides: "Hook configuration for SessionStart event"
      contains: "SessionStart"
  key_links:
    - from: "hooks/hooks.json"
      to: "scripts/session-start.sh"
      via: "command field referencing script path"
      pattern: "CLAUDE_PLUGIN_ROOT.*session-start"
    - from: "scripts/init-director.sh"
      to: ".director/"
      via: "creates folder structure with VISION.md, GAMEPLAN.md, STATE.md, IDEAS.md, config.json, brainstorms/, goals/"
      pattern: "mkdir.*director"
---

<objective>
Create the plugin manifest, initialization infrastructure, and plugin-level instructions that everything else depends on.

Purpose: Without the manifest, no skills or agents register. Without the init script, .director/ doesn't get created. This is the foundation that must exist before any other component.
Output: A loadable plugin manifest, silent initialization script, session start hook, and plugin CLAUDE.md.
</objective>

<execution_context>
@/Users/noahrasheta/.claude/get-shit-done/workflows/execute-plan.md
@/Users/noahrasheta/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-plugin-foundation/01-RESEARCH.md
@.planning/phases/01-plugin-foundation/01-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create plugin manifest and plugin-level CLAUDE.md</name>
  <files>.claude-plugin/plugin.json, CLAUDE.md</files>
  <action>
Create `.claude-plugin/plugin.json` with:
- `name: "director"` (this namespaces all skills as `/director:*`)
- `description`: "Opinionated, spec-driven orchestration framework for vibe coders. Guides the entire build process from vision to working product."
- `version: "0.1.0"`
- `author.name: "Noah Rasheta"`
- `homepage: "https://director.cc"`
- `repository: "https://github.com/noahrasheta/director"`
- `license: "MIT"`
- `keywords: ["orchestration", "vibe-coding", "workflow", "planning", "ai-agents"]`

IMPORTANT: Only `plugin.json` goes inside `.claude-plugin/`. All other components (skills, agents, hooks) go at the plugin root. Getting this wrong causes silent failures.

Create `CLAUDE.md` at the plugin root (this is the PLUGIN-level CLAUDE.md, separate from the project's existing CLAUDE.md). Wait -- the project already has a CLAUDE.md at the root. The plugin IS the project root. So update the existing CLAUDE.md to include plugin-level instructions that Claude Code loads into every agent context.

Actually, since the plugin root IS the project root, the existing CLAUDE.md already serves as the plugin CLAUDE.md. Do NOT create a second one. Instead, add a clearly marked section to the existing CLAUDE.md with minimal always-applicable rules:

Add to the existing CLAUDE.md under a new `## Plugin Runtime Instructions` section:
- Director vocabulary: Goal, Step, Task, Action (never Phase, Sprint, Ticket, Issue)
- User-facing language: Vision, Gameplan, Launch (never spec, deploy, release)
- Never use jargon in user-facing output: no "dependencies", "artifact wiring", "integration testing", "worktrees"
- Always check for `.director/` existence before any Director operation
- If `.director/` is missing, create it silently using `scripts/init-director.sh`
- Git operations are invisible to users: say "Progress saved" not commit SHAs

Keep this section SHORT (under 30 lines). Detailed guidance belongs in reference docs.
  </action>
  <verify>
Verify `.claude-plugin/plugin.json` is valid JSON with `cat .claude-plugin/plugin.json | python3 -m json.tool`.
Verify `CLAUDE.md` contains the "Plugin Runtime Instructions" section with `grep "Plugin Runtime Instructions" CLAUDE.md`.
  </verify>
  <done>plugin.json exists with name "director" and is valid JSON. CLAUDE.md has plugin runtime instructions section with terminology rules and jargon prohibition.</done>
</task>

<task type="auto">
  <name>Task 2: Create init script, session-start hook, and hooks configuration</name>
  <files>scripts/init-director.sh, scripts/session-start.sh, hooks/hooks.json</files>
  <action>
Create `scripts/init-director.sh` -- the silent `.director/` initialization script:
- Starts with `#!/usr/bin/env bash` and `set -euo pipefail`
- Exits silently if `.director/` already exists (idempotent)
- Creates: `.director/VISION.md` (empty template with section headers and "This file will be populated when you run /director:onboard"), `.director/GAMEPLAN.md` (empty template), `.director/STATE.md` (initial state with "Not started"), `.director/IDEAS.md` (empty with header), `.director/config.json` (opinionated defaults), `.director/brainstorms/` (empty dir), `.director/goals/` (empty dir)
- Config defaults per user decision: config_version: 1, mode: "guided", tips: true, verification: true, cost_tracking: true, doc_sync: true, max_retry_cycles: 3, language: "en", agents object with model assignments (interviewer: inherit, planner: inherit, researcher: inherit, mapper: haiku, builder: inherit, verifier: haiku, debugger: inherit, syncer: haiku)
- Initializes git silently if no `.git/` exists: `git init -q` then add and commit `.director/` files with message "Initialize Director project". No mention of git to the user.
- Uses `${CLAUDE_PLUGIN_ROOT}` for any plugin path references (the script itself doesn't need this but document it in comments for future use)

Create `scripts/session-start.sh` -- runs on SessionStart hook:
- Starts with `#!/usr/bin/env bash`
- Checks if `.director/STATE.md` exists
- If exists: outputs a brief JSON status summary that Claude can use to be project-aware (e.g., current position, active goal). Keep output minimal.
- If not exists: outputs nothing (no project yet, nothing to load)
- This supports the "every command is smart about project state from day one" requirement

Create `hooks/hooks.json`:
- SessionStart hook that runs `${CLAUDE_PLUGIN_ROOT}/scripts/session-start.sh` with timeout: 5 and statusMessage: "Loading Director..."
- Use the matcher "startup" for SessionStart

Make both scripts executable with `chmod +x`.
  </action>
  <verify>
Run `bash scripts/init-director.sh` in a temp directory and verify it creates the full `.director/` structure: `ls -la /tmp/test-director/.director/` should show VISION.md, GAMEPLAN.md, STATE.md, IDEAS.md, config.json, brainstorms/, goals/.
Verify config.json is valid JSON with `python3 -m json.tool .director/config.json`.
Verify hooks.json is valid JSON with `python3 -m json.tool hooks/hooks.json`.
Verify scripts are executable with `test -x scripts/init-director.sh && test -x scripts/session-start.sh && echo "OK"`.
  </verify>
  <done>init-director.sh creates complete .director/ structure with all files and opinionated config defaults. session-start.sh loads project state for context awareness. hooks.json configures SessionStart to run session-start.sh. Both scripts are executable.</done>
</task>

</tasks>

<verification>
1. `.claude-plugin/plugin.json` exists and is valid JSON with name "director"
2. CLAUDE.md has plugin runtime instructions with terminology rules
3. `scripts/init-director.sh` creates `.director/` with all 5 files and 2 directories
4. `.director/config.json` has config_version: 1 and all opinionated defaults
5. `scripts/session-start.sh` outputs state summary when `.director/` exists, nothing when it doesn't
6. `hooks/hooks.json` references session-start.sh correctly
7. Both scripts have executable permissions
</verification>

<success_criteria>
Plugin manifest registers Director with Claude Code. Init script creates complete .director/ folder structure silently with opinionated config defaults. Session start hook provides project state awareness. All files are valid and scripts are executable.
</success_criteria>

<output>
After completion, create `.planning/phases/01-plugin-foundation/01-01-SUMMARY.md`
</output>
