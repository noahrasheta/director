---
phase: 03-planning
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/blueprint/SKILL.md
autonomous: true

must_haves:
  truths:
    - "Running /director:blueprint reads VISION.md and generates Goals as outcomes (not activities)"
    - "Goals are presented all together for user review before any Steps or Tasks are generated"
    - "After the user approves goals, Steps and Tasks are generated without additional pause points"
    - "The complete hierarchy (Goals > Steps > Tasks) is shown with one-line descriptions and plain-language dependencies"
    - "Blueprint asks 'Does this look good?' and waits for explicit approval before writing any files"
    - "After approval, GAMEPLAN.md and the goals/ directory hierarchy are written with all goal, step, and task files"
    - "File operations are narrated conversationally ('Your gameplan is saved') not technically"
  artifacts:
    - path: "skills/blueprint/SKILL.md"
      provides: "Full blueprint workflow for new gameplan creation"
      min_lines: 200
  key_links:
    - from: "skills/blueprint/SKILL.md"
      to: ".director/VISION.md"
      via: "Read tool at start of workflow"
      pattern: "Read.*VISION\\.md"
    - from: "skills/blueprint/SKILL.md"
      to: ".director/GAMEPLAN.md"
      via: "Write tool after approval"
      pattern: "GAMEPLAN\\.md"
    - from: "skills/blueprint/SKILL.md"
      to: ".director/goals/"
      via: "Bash mkdir + Write tool for goal/step/task files"
      pattern: "goals/"
---

<objective>
Rewrite the blueprint skill to orchestrate the full gameplan creation workflow inline -- reading VISION.md, generating Goals for interactive review, filling in Steps and Tasks after approval, presenting the complete hierarchy, getting explicit approval, and writing all files to `.director/`.

Purpose: This is the core planning capability. Users go from a vision document to a complete, reviewable gameplan through a guided conversation. Without this, Director cannot guide the build process.

Output: A fully functional `skills/blueprint/SKILL.md` that handles new gameplan creation (update mode is Plan 02).
</objective>

<execution_context>
@/Users/noahrasheta/.claude/get-shit-done/workflows/execute-plan.md
@/Users/noahrasheta/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-planning/03-RESEARCH.md
@skills/blueprint/SKILL.md
@agents/director-planner.md
@skills/blueprint/templates/gameplan-template.md
@skills/blueprint/templates/goal-template.md
@skills/blueprint/templates/step-template.md
@skills/blueprint/templates/task-template.md
@skills/onboard/SKILL.md
@reference/terminology.md
@reference/plain-language-guide.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite blueprint SKILL.md with full new-gameplan workflow</name>
  <files>skills/blueprint/SKILL.md</files>
  <action>
Rewrite `skills/blueprint/SKILL.md` to replace the placeholder "coming soon" stubs with the complete new gameplan creation workflow. The skill runs inline (no sub-agent spawning for the planner -- same pattern as onboard SKILL.md).

**Structure the skill in these sections:**

1. **Init check** (keep existing pattern): Check `.director/` exists, run init script silently if not, say "Director is ready."

2. **Determine Project State**: Read `.director/VISION.md` and check for real content.
   - If VISION.md is empty/template: route to onboard conversationally (keep existing routing behavior).
   - If VISION.md has content: read `.director/GAMEPLAN.md` and check for real content.
   - Template detection for GAMEPLAN.md: check for phrases like "This file will be populated when you run /director:blueprint" AND check for `_No goals defined yet_` AND check whether there are actual goal headings with content. If template only -> NEW gameplan mode. If real content -> UPDATE mode (handled in Plan 02 -- for now, set up the detection and route to a placeholder for update mode that says "Update mode coming soon" with acknowledgment of $ARGUMENTS if provided).

3. **Handle Arguments**: If $ARGUMENTS is non-empty, acknowledge it: "You want to focus on [arguments]. Let me read your vision and create a gameplan."

4. **Check for [UNCLEAR] markers**: Before generating goals, scan VISION.md for [UNCLEAR] markers. If found, present them to the user and ask to resolve before planning. If user wants to defer, note that affected tasks may need adjustment later.

5. **Phase 1: Generate and Review Goals** (this is the core section):
   - Include the planner agent's planning rules as inline reference content (copy Rules 1-6, complexity indicators, and dependency language directly into the skill so Claude follows them). Do NOT reference the agent file -- embed the rules.
   - Read VISION.md content to understand the project.
   - Generate 2-4 goals as outcomes, not activities. Each goal has a name and 1-2 sentence explanation of why it matters.
   - Present ALL goals together (not one at a time) in numbered format:
     ```
     Based on your vision, here are the goals I'd suggest:

     1. **[Goal as outcome]** -- [Why this matters]
     2. **[Goal as outcome]** -- [Why this matters]
     3. **[Goal as outcome]** -- [Why this matters]

     Does this feel right? Want to add, remove, or rearrange anything?
     ```
   - Wait for user response. If they give feedback, adjust and re-present. Iterate until they approve.
   - Include explicit examples of good goals ("Users can sign up, log in, and manage their profiles") vs bad goals ("Build authentication system") directly in the instructions.

6. **Phase 2: Generate Full Hierarchy** (after goal approval):
   - For each approved goal, generate Steps (verifiable chunks that deliver something visible).
   - For each step, generate Tasks with all 5 required fields: What To Do, Why It Matters, Size (small/medium/large), Done When (3-5 checklist items), Needs First (plain language capabilities, never task IDs).
   - Include the complexity indicators table (Small/Medium/Large) as inline reference.
   - Prefer vertical slices over horizontal layers (include good/bad ordering examples).
   - Use ready-work filtering: mark tasks with no unmet prerequisites as "Ready".
   - Present the full outline with one-line descriptions:
     ```
     Here's the complete gameplan:

     **Goal 1: [Name]**

       Step 1: [Step name]
         - [Task name] (size) -- Ready
         - [Task name] (size) -- Needs [capability]

       Step 2: [Step name]
         - [Task name] (size) -- Needs [capability]

     **Goal 2: [Name]**
       ...

     Does this look good? Want to change the order, add anything, or remove anything?
     ```
   - Wait for explicit approval. Iterate if user gives feedback.

7. **Write Gameplan** (after explicit approval):
   - Write `.director/GAMEPLAN.md` following the gameplan template structure (Overview with project summary, Goals listed with one-line descriptions, Current Focus section pointing to Goal 1 Step 1).
   - For each goal: create directory `.director/goals/NN-goal-slug/`, write `GOAL.md` following goal template (What Success Looks Like, Steps list, Status).
   - For each step: create directory `.director/goals/NN-goal/NN-step-slug/`, write `STEP.md` following step template (What This Delivers, Tasks list, Needs First).
   - For each task: create directory `.director/goals/NN-goal/NN-step/tasks/`, write `NN-task-slug.md` following task template (all 5 fields).
   - Use Bash for mkdir -p and Write tool for file content.
   - Directory naming: zero-padded numbers with kebab-case slugs (e.g., `01-user-accounts/`).

8. **Conversational file operations**: After writing all files, say something like:
   > "Your gameplan is saved. I created [N] goals with [M] steps and [T] tasks total. You can browse the full plan in `.director/goals/` if you're curious, but Director handles everything from here."

   Do NOT narrate each file path or mkdir command.

9. **Suggest Next Step**:
   > "Ready to start building? You can do that with `/director:build`."

   Wait for user response. Do not auto-execute.

10. **Language Reminders** (same pattern as onboard SKILL.md): Include a Language Reminders section at the end with Director terminology rules, conversational tone reminders, and never-use jargon list.

11. **$ARGUMENTS** at the very end of the file (required for Claude Code skills).

**Important implementation details:**
- The planner agent's rules (Rules 1-6, complexity table, dependency language, vertical slices) must be EMBEDDED directly in the skill instructions, not referenced as "see agents/director-planner.md". Claude needs to see the rules in context to follow them. This matches how the onboard skill embeds interviewer rules rather than referencing the agent file.
- The skill MUST NOT use `context: fork` or spawn the planner agent. The workflow runs inline for the multi-turn conversation (per research recommendation).
- Goal-level review is the ONLY user checkpoint. After goals are approved, Steps and Tasks are generated without pausing for additional review (except the final "Does this look good?" on the full outline).
- Keep the update mode detection logic in the "Determine Project State" section, but route update mode to a placeholder for now (Plan 02 fills this in). The placeholder should say something conversational like: "I can see you already have a gameplan. Updating an existing gameplan will be available in a future update."
  </action>
  <verify>
Read the resulting `skills/blueprint/SKILL.md` and verify:
1. File has valid YAML frontmatter with name: blueprint and description
2. Contains init check with bash script
3. Contains VISION.md reading and template detection
4. Contains GAMEPLAN.md reading and new-vs-update mode detection
5. Contains $ARGUMENTS handling
6. Contains [UNCLEAR] marker scanning
7. Contains Phase 1 goal generation with inline planner rules (Rules 1-6 embedded, not referenced)
8. Contains Phase 2 full hierarchy generation with complexity table and vertical slice guidance
9. Contains file writing instructions for GAMEPLAN.md + goals/ hierarchy
10. Contains conversational file operation language
11. Contains next step suggestion
12. Contains Language Reminders section
13. Ends with $ARGUMENTS
14. Does NOT contain "coming soon" or "future update" for new gameplan creation (only for update mode)
15. Does NOT spawn the planner agent via Task tool or context: fork
  </verify>
  <done>
The blueprint skill handles the complete new-gameplan creation flow: reads VISION.md, generates Goals for interactive review, fills in Steps and Tasks after approval, presents the full hierarchy, gets explicit approval, writes all files to .director/, and suggests /director:build as next step. Update mode detection exists but routes to a placeholder.
  </done>
</task>

</tasks>

<verification>
- Read `skills/blueprint/SKILL.md` and confirm it follows the two-phase conversation flow (goals first, then full hierarchy)
- Confirm planner rules are embedded inline, not referenced
- Confirm all 5 task fields are specified (What To Do, Why It Matters, Size, Done When, Needs First)
- Confirm file writing uses gameplan, goal, step, and task template structures
- Confirm no developer jargon in user-facing messages (check against reference/terminology.md)
- Confirm $ARGUMENTS is handled before goal generation
- Confirm [UNCLEAR] markers are checked before planning begins
</verification>

<success_criteria>
- skills/blueprint/SKILL.md is a complete, functional skill (not a placeholder) for new gameplan creation
- The two-phase flow is explicit: goals -> approval -> hierarchy -> approval -> write
- Planner agent rules 1-6 are embedded in the skill
- Five task fields match the task template exactly
- File writing creates GAMEPLAN.md + goals/ directory hierarchy
- All user-facing language follows Director terminology (no jargon)
- Update mode detection exists and routes to placeholder (not broken -- just not yet implemented)
</success_criteria>

<output>
After completion, create `.planning/phases/03-planning/03-01-SUMMARY.md`
</output>
