---
phase: 08-pivot-brainstorm
plan: "04"
type: execute
wave: 4
depends_on: ["08-03"]
files_modified:
  - skills/pivot/SKILL.md
autonomous: true

must_haves:
  truths:
    - "Strategic pivots update VISION.md first (with user review) then GAMEPLAN.md"
    - "Tactical pivots update GAMEPLAN.md only -- VISION.md is untouched"
    - "Pivot writes new/modified goal, step, and task files to .director/goals/"
    - "Completed items are never deleted from the file system"
    - "STATE.md is updated with new current position pointing to the first ready task"
    - "Pivot ends with a conversational summary and suggests /director:build"
  artifacts:
    - path: "skills/pivot/SKILL.md"
      provides: "Complete pivot skill with all 9 steps -- init through wrap-up"
      min_lines: 320
  key_links:
    - from: "skills/pivot/SKILL.md"
      to: ".director/VISION.md"
      via: "Direct write for strategic pivots after user review"
      pattern: "VISION.md"
    - from: "skills/pivot/SKILL.md"
      to: ".director/GAMEPLAN.md"
      via: "Direct rewrite with updated goals/steps/tasks"
      pattern: "GAMEPLAN.md"
    - from: "skills/pivot/SKILL.md"
      to: ".director/STATE.md"
      via: "Direct update with new current position and pivot activity entry"
      pattern: "STATE.md"
---

<objective>
Complete the pivot skill by adding Steps 8-9 -- applying approved changes to all project documentation and wrapping up with a conversational summary. This is the "make it happen" phase where approved changes are written to disk.

Purpose: Steps 8-9 take the approved delta and turn it into actual file changes. Strategic pivots update VISION.md first, then GAMEPLAN.md and all goal/step/task files. Tactical pivots update only GAMEPLAN.md and goal/step/task files. STATE.md is updated in all cases to point to the first ready task in the new gameplan.

Output: A complete `skills/pivot/SKILL.md` with all 9 steps -- the placeholder is removed and the skill is fully functional.
</objective>

<execution_context>
@/Users/noahrasheta/.claude/get-shit-done/workflows/execute-plan.md
@/Users/noahrasheta/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-pivot-brainstorm/08-CONTEXT.md
@.planning/phases/08-pivot-brainstorm/08-RESEARCH.md
@.planning/phases/08-pivot-brainstorm/08-03-SUMMARY.md

@skills/pivot/SKILL.md
@skills/blueprint/SKILL.md
@skills/build/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add pivot Steps 8-9 (apply changes + STATE.md update + wrap-up)</name>
  <files>skills/pivot/SKILL.md</files>
  <action>
Read the current `skills/pivot/SKILL.md` (which has Steps 1-7 from plans 08-01 through 08-03). Replace the `<!-- Steps 8-9 -->` placeholder with Steps 8-9 to complete the skill. Remove all placeholder markers.

**Step 8: Apply changes**

After the user explicitly approves the delta summary from Step 7, apply all changes:

**8a: VISION.md update (strategic pivots only)**
- If the pivot is strategic (detected in Step 3): rewrite `.director/VISION.md` with the updated vision.
- Present the updated vision to the user for review BEFORE writing: "Here's the updated vision for your project:" followed by the full VISION.md content. Wait for approval. If feedback, adjust and re-present.
- Use the same document structure as the onboard template (project name, purpose, target users, key features, tech stack, deployment, success criteria).
- For features, use delta format labels where helpful (Existing/Adding/Changing/Removing).
- Only write after the user confirms.
- If the pivot is tactical: skip this step entirely -- VISION.md stays as-is.

**8b: GAMEPLAN.md update**
- Rewrite `.director/GAMEPLAN.md` with the updated gameplan overview, goals list, and current focus section.
- Same format as blueprint skill's Write Gameplan section.
- Current Focus should point to the first ready task in the updated plan.

**8c: Goal, Step, and Task file updates**
- For completed items: do NOT touch their files. Leave them exactly as they are on disk.
- For modified items: overwrite the existing GOAL.md, STEP.md, or task file with updated content.
- For new items: create new directories and files following the same naming conventions (zero-padded numbers, kebab-case slugs). Use `mkdir -p` via Bash, Write tool for content.
- For removed pending items: delete the files and directories. But NEVER delete files for completed items.
- Follow the same file templates and directory structure as blueprint (GOAL.md, STEP.md, task files with What To Do, Why It Matters, Size, Done When, Needs First sections).

**8d: Decisions in modified/new steps**
- For completed steps: FROZEN -- do not modify their Decisions sections.
- For modified pending steps: review the pivot conversation for new decisions. Merge new decisions with existing ones (same rules as blueprint update mode -- new Locked items from pivot context, contradicted decisions updated, newly deferred items moved).
- For new steps: capture decisions from the pivot conversation using the same passive extraction approach as blueprint.

**8e: STATE.md update**
- Update STATE.md directly (do NOT spawn the syncer -- pivot is a meta-operation, not a build task).
- Recalculate progress by scanning the new file system structure (count .done.md files vs total task files).
- Update Current Position to point to the first ready task in the updated gameplan.
- Add a Recent Activity entry for the pivot: `- **[YYYY-MM-DD]** -- Pivot: [brief description of what changed]`
- If strategic: also update the "Current focus" description.

**Step 9: Wrap-up**

Tell the user conversationally what happened:

> "Your gameplan is updated. [Brief summary of the key changes -- e.g., 'Switched to GraphQL across the API steps and added 2 new tasks for schema migration.' or 'The vision now focuses on enterprise teams, and the gameplan has 3 new goals to match.']"

Do NOT list file paths, directory structures, or technical details. The user just needs to know what changed at a high level.

Then suggest next action:

> "Ready to keep building? You can pick up where things left off with `/director:build`."

Wait for the user's response. Do not auto-execute the next command.

**Complete the Language Reminders section:**
Ensure the Language Reminders section at the bottom covers:
- Director vocabulary (Vision, Gameplan, Goal/Step/Task)
- No git jargon (say "Progress saved" not "Changes committed")
- File operations invisible (never show paths in user output)
- Conversational tone, match user's energy
- Never blame the user
- Follow terminology.md and plain-language-guide.md

Ensure `$ARGUMENTS` is at the very end of the file.

**Important implementation details:**
- Pivot updates STATE.md directly (research recommendation -- syncer expects build-task context that does not apply here)
- VISION.md update for strategic pivots has its own approval gate (separate from the delta approval)
- Completed work files are NEVER deleted, even if flagged as irrelevant
- The wrap-up is conversational, not a report -- brief and forward-looking
  </action>
  <verify>
Read `skills/pivot/SKILL.md` and verify:
1. No placeholder markers remain (all `<!-- Steps -->` comments removed)
2. Step 8a updates VISION.md only for strategic pivots with separate approval
3. Step 8b rewrites GAMEPLAN.md with updated structure
4. Step 8c handles completed (frozen), modified (overwrite), new (create), removed (delete pending only)
5. Step 8d handles decisions in steps (frozen for completed, merge for modified, capture for new)
6. Step 8e updates STATE.md directly (progress, current position, activity entry)
7. Step 9 has conversational summary and suggests /director:build
8. Language reminders section is complete
9. $ARGUMENTS at the end
10. File is at least 320 lines
11. All 9 steps are present and numbered sequentially
  </verify>
  <done>
Pivot skill is fully complete with all 9 steps: init and routing (Steps 1), conversation capture (Step 2), scope detection (Step 3), in-progress work check (Step 4), conditional mapper spawning (Step 5), impact analysis (Step 6), delta summary with approval (Step 7), apply changes with strategic VISION.md update, GAMEPLAN.md rewrite, file operations, decisions handling, and STATE.md update (Step 8), and conversational wrap-up (Step 9). The skill handles both tactical and strategic pivots end-to-end.
  </done>
</task>

</tasks>

<verification>
- Complete pivot skill: all 9 steps present, no placeholders remain
- Strategic pivots update VISION.md (with approval) then GAMEPLAN.md
- Tactical pivots update GAMEPLAN.md only
- Completed work files are never deleted
- STATE.md updated directly with recalculated progress and new current position
- Decisions handled correctly: frozen for completed, merged for modified, captured for new
- Conversational wrap-up suggests /director:build
</verification>

<success_criteria>
- Pivot skill is a complete, functional skill file (not a placeholder, not a partial implementation)
- All FLEX-04 through FLEX-09 requirements are addressed
- All locked decisions from CONTEXT.md are honored
- Pattern consistency with blueprint update mode maintained throughout
</success_criteria>

<output>
After completion, create `.planning/phases/08-pivot-brainstorm/08-04-SUMMARY.md`
</output>
